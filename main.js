(()=>{"use strict";class e{constructor(e,t,{handleOpenPopup:s}){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleOpenPopup=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._buttonLike.addEventListener("click",(()=>this._toggleLike())),this._element.querySelector(".card__trash-button").addEventListener("click",(()=>this._deleteCard())),this._cardImage.addEventListener("click",(()=>this._openPopup()))}_toggleLike(){this._buttonLike.classList.toggle("card__like-button_active")}_deleteCard(){this._element.remove(),this._element=null}_openPopup(){this._handleOpenPopup(this._name,this._link)}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__photo"),this._buttonLike=this._element.querySelector(".card__like-button"),this._setEventListeners(),this._element.querySelector(".card__title").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._element}}class t{constructor(e,t){this._formElement=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}offButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled","disabled")}onButton(){this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled")}_toggleButtonState(){this._hasInvalidInput()?this.offButton():this.onButton()}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(),this._toggleButtonState()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}}class s{constructor(e){this._popupSelector=document.querySelector(e),this._crossButton=document.querySelector(e+"__cross-button"),this._handleEscClose=this._handleEscClose.bind(this),this._handleBGClose=this._handleBGClose.bind(this)}open(){this._popupSelector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleBGClose(e){e.target===this._popupSelector&&this.close()}setEventListeners(){this._crossButton.addEventListener("click",(()=>{this.close()})),this._popupSelector.addEventListener("click",this._handleBGClose)}}class n extends s{constructor(e,{submitCallback:t}){super(e),this._submitCallback=t,this._inputbox=document.querySelector(e+"__inputbox"),this._inputList=Array.from(this._inputbox.querySelectorAll(".popup__input"))}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.getAttribute("name")]=t.value})),e}setEventListeners(){this._inputbox.addEventListener("submit",(e=>{e.preventDefault(),this._submitCallback(this._getInputValues())})),super.setEventListeners()}close(){this._inputbox.reset(),super.close()}}const o=document.querySelector(".popup-profile__inputbox"),i=document.querySelector(".popup-add__inputbox"),r=document.querySelector(".popup__input_type_name"),l=document.querySelector(".popup__input_type_job"),u=document.querySelector(".profile__edit-button"),c=(document.querySelector(".popup-photo"),document.querySelector(".popup-photo__img"),document.querySelector(".popup-photo__title"),document.querySelector(".profile__add-button")),p={formSelector:".popup__inputbox",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_inactive",inputErrorClass:"popup__input-error_active",errorClass:"popup__input-error"},a=new class{constructor({nameElementSelector:e,infoElementSelector:t}){this._nameElement=document.querySelector(e),this._infoElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,info:this._infoElement.textContent}}setUserInfo({job:e,name:t}){this._nameElement.textContent=t,this._infoElement.textContent=e}}({nameElementSelector:".profile__name",infoElementSelector:".profile__stat"});new t(p,o).enableValidation();const _=new t(p,i);_.enableValidation(),c.addEventListener("click",(function(){_.resetValidation(),h.open()})),u.addEventListener("click",(function(){const{name:e,info:t}=a.getUserInfo();r.value=e,l.value=t,m.open()}));const d=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._items.forEach((e=>this.renderItem(e)))}addItem(e){this._container.prepend(e)}renderItem(e){this.addItem(this._renderer(e))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:t=>new e(t,"#card-template",{handleOpenPopup:(e,t)=>{E.open(e,t)}}).generateCard()},".cards");d.renderItems();const h=new n(".popup-add",{submitCallback:function(e){d.renderItem(e),h.close()}});h.setEventListeners();const m=new n(".popup-profile",{submitCallback:function(e){a.setUserInfo(e),m.close()}});m.setEventListeners();const E=new class extends s{constructor(e){super(e),this._img=this._popupSelector.querySelector(".popup-photo__img"),this._title=this._popupSelector.querySelector(".popup-photo__title"),this._inputSrc=document.querySelector("#mesto-src"),this._inputText=document.querySelector("#mesto-name")}open(e,t){this._img.src=t,this._img.alt=e,this._title.textContent=e,super.open()}}(".popup-photo");E.setEventListeners()})();